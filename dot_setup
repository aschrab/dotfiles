#!/usr/bin/env perl

use strict;
use warnings;
use Path::Class;

my $home = dir( $ENV{HOME} );
my $dir = file($0)->dir->relative($home);

foreach my $f (@ARGV) {
  chomp $f;
  next if $f =~ /dot_setup/;
  if( $f =~ /USUAL/ ) {
	push @ARGV, $home->subdir($dir)->file('USUAL')->slurp;
	next;
  }

  my $dest = "$ENV{HOME}/.$f";
  if( -e $dest ) {
    print ". $f\n";
  }
  else {
    print "+ $f\n";
    symlink "$dir/$f" => $dest or die;
  }
}
